Search.setIndex({"docnames": ["citation", "getting_started/algorithm", "getting_started/quickstart", "index", "io", "quant"], "filenames": ["citation.rst", "getting_started/algorithm.ipynb", "getting_started/quickstart.ipynb", "index.rst", "io.rst", "quant.rst"], "titles": ["Credit", "Methodology", "Quickstart", "About", "<cite>hplc.io</cite>", "<cite>hplc.quant</cite>"], "terms": {"thi": [0, 1, 2, 3, 4, 5], "packag": [0, 2, 3], "i": [0, 1, 2, 3, 4, 5], "primarili": [0, 5], "written": 0, "griffin": 0, "chure": 0, "contribut": 0, "from": [0, 1, 2, 3, 4, 5], "jona": 0, "cremer": 0, "http": [0, 3], "cremerlab": [0, 3], "github": [0, 3], "io": [0, 2], "who": 0, "ar": [0, 1, 2, 3, 5], "both": 0, "stanford": 0, "univers": 0, "support": 0, "nation": 0, "scienc": 0, "foundat": 0, "postdoctor": 0, "research": 0, "fellowship": 0, "under": [0, 1, 5], "award": 0, "number": [0, 5], "2010807": 0, "If": [0, 2, 3, 4, 5], "you": [0, 1, 2, 3, 5], "end": [0, 5], "up": [0, 2], "us": [0, 1, 2, 3, 5], "your": [0, 3], "great": 0, "pleas": 0, "consid": [0, 1, 2, 5], "project": 0, "The": [0, 2, 3, 4, 5], "being": 0, "activ": [0, 1], "develop": [0, 1, 3], "improv": 0, "so": 0, "ensur": 0, "version": [0, 3], "A": [0, 2, 5], "formal": 0, "bibtex": 0, "citat": 0, "kei": [0, 4, 5], "includ": [0, 2, 5], "here": [0, 5], "when": [0, 2], "repositori": 0, "regist": 0, "zenodo": 0, "note": [1, 2, 5], "notebook": 1, "chang": 1, "lot": 1, "h": 1, "igh": 1, "p": 1, "erform": 1, "l": 1, "iquid": 1, "c": [1, 2], "hromatographi": 1, "hplc": [1, 2, 3], "an": [1, 2, 3, 5], "analyt": [1, 3], "techniqu": [1, 3], "which": [1, 2, 3, 5], "allow": [1, 2, 3, 5], "quantit": [1, 3], "character": [1, 3], "chemic": [1, 3], "compon": 1, "while": [1, 3], "mani": [1, 2, 3], "technic": [1, 3], "detail": [1, 2, 3], "now": [1, 2, 3], "autom": [1, 2, 3], "programmat": [1, 3], "clean": [1, 3], "process": [1, 3, 5], "result": [1, 2, 3], "data": [1, 2, 3], "can": [1, 2, 3, 5], "cumbersom": [1, 3], "often": [1, 2, 3], "requir": [1, 3], "extens": [1, 3], "manual": [1, 2, 3], "labor": [1, 3], "scenario": 1, "where": [1, 5], "have": [1, 2, 5], "environment": 1, "sampl": [1, 2], "contain": [1, 2, 4, 5], "sever": 1, "differ": 1, "speci": 1, "through": [1, 2, 5], "principl": 1, "chromatograph": [1, 3], "separ": [1, 3, 4], "instrument": 1, "decompos": 1, "its": [1, 2, 5], "measur": [1, 2], "time": [1, 2, 3, 5], "take": [1, 5], "each": [1, 5], "pass": [1, 2, 5], "column": [1, 2, 4, 5], "mai": [1, 2, 5], "look": [1, 3], "someth": [1, 2], "like": [1, 2, 3], "import": [1, 2], "panda": [1, 2, 3, 4, 5], "pd": 1, "matplotlib": [1, 5], "pyplot": 1, "plt": 1, "seaborn": [1, 3], "sn": 1, "set": [1, 2, 5], "load": [1, 4], "read_csv": 1, "sample_chromatogram": 1, "txt": [1, 2], "plot": [1, 5], "fig": [1, 5], "ax": [1, 2, 5], "subplot": 1, "time_min": 1, "intensity_mv": 1, "k": 1, "set_xlim": 1, "10": [1, 2, 5], "20": [1, 2], "set_xlabel": 1, "min": [1, 2], "set_ylabel": 1, "mv": 1, "text": [1, 2, 4, 5], "0": [1, 2, 5], "39": [1, 2], "By": [1, 2], "ey": 1, "six": 1, "individu": [1, 5], "compound": [1, 2, 5], "some": 1, "isol": [1, 2], "e": [1, 4, 5], "g": [1, 5], "11": [1, 2], "other": [1, 2], "overlap": 1, "13": [1, 2], "15": [1, 2], "indic": [1, 5], "similar": [1, 2], "elut": 1, "particular": 1, "mobil": 1, "phase": 1, "easi": 1, "u": 1, "see": [1, 2, 5], "do": 1, "we": [1, 2], "quantifi": [1, 5], "them": 1, "teas": 1, "apart": 1, "easier": [1, 2], "sai": 1, "than": [1, 2], "There": 1, "tool": 1, "avail": [1, 5], "open": 1, "sourc": 1, "happytool": 1, "proprietari": 1, "chromeleon": 1, "howev": [1, 2], "case": [1, 2, 5], "simpli": 1, "onli": [1, 2, 5], "non": [1, 5], "region": [1, 2, 5], "py": [1, 3], "fit": [1, 5], "skewnorm": 1, "distribut": [1, 2, 5], "either": 1, "singular": 1, "highli": 1, "one": [1, 2, 5], "go": [1, 2], "abov": 1, "few": 1, "line": [1, 4], "python": [1, 3], "code": 1, "show": [1, 2, 5], "power": 1, "quant": [1, 2], "chrom": [1, 2], "col": [1, 5], "fit_peak": [1, 2, 5], "displai": [1, 2, 5], "time_rang": [1, 5], "head": [1, 2], "perform": [1, 2, 3, 5], "178": 1, "00": [1, 2], "lt": [1, 2], "": [1, 2, 4, 5], "100": [1, 2, 5], "696": 1, "37it": 1, "deconvolv": 1, "33it": 1, "retention_tim": [1, 2, 5], "scale": [1, 2, 5], "skew": [1, 2, 5], "amplitud": [1, 2, 5], "area": [1, 2, 5], "peak_id": [1, 2, 5], "904346": [1, 2], "157576": [1, 2], "677681": [1, 2], "23248": [1, 2], "375226": 1, "789805e": [1, 2], "06": [1, 2], "170560": 1, "582716": 1, "838973": 1, "42239": 1, "437428": 1, "068732e": 1, "14": [1, 2], "447586": 1, "353081": 1, "019459": 1, "35236": 1, "424407": 1, "228371e": 1, "531773": 1, "312543": 1, "630870": 1, "14888": 1, "892959": 1, "786667e": 1, "16": [1, 2], "522116": 1, "344196": 1, "983761": 1, "10768": 1, "016016": 1, "292162e": 1, "detect": [1, 3, 5], "quantif": [1, 2, 3, 5], "algorithm": [1, 2, 5], "involv": [1, 2], "follow": [1, 2, 3, 5], "background": [1, 2, 5], "statist": [1, 2, 5], "nonlinear": [1, 5], "iter": [1, 5], "snip": [1, 5], "automat": [1, 2, 5], "given": [1, 5], "threshold": [1, 5], "criteria": 1, "promin": [1, 2, 5], "least": [1, 5], "stack": 1, "heavili": 1, "group": 1, "singl": [1, 2], "For": [1, 5], "n": [1, 5], "normal": [1, 2, 5], "disttribut": 1, "infer": [1, 2, 5], "properti": [1, 2, 5], "locat": [1, 2, 5], "maximum": [1, 2, 5], "valu": [1, 2, 4, 5], "width": [1, 2, 5], "half": [1, 2, 5], "initi": [1, 2], "guess": [1, 2], "optim": [1, 5], "minim": [1, 5], "procedur": [1, 5], "repeat": 1, "best": 1, "paramet": [1, 2, 4, 5], "expect": 1, "across": [1, 5], "entir": [1, 5], "observ": [1, 2, 5], "comput": [1, 2, 5], "over": 1, "store": [1, 5], "all": [1, 2], "rest": 1, "examin": 1, "implement": [1, 5], "meant": 2, "get": 2, "rapidli": 2, "possibl": 2, "below": [2, 5], "brief": 2, "exampl": 2, "how": 2, "raw": 2, "off": 2, "machin": 2, "list": [2, 4, 5], "absolut": 2, "concentr": [2, 5], "file": [2, 4, 5], "signal": [2, 5], "inform": [2, 5], "intellig": 2, "read": 2, "datafram": [2, 4, 5], "load_chromatogram": [2, 4], "1": [2, 5], "df": [2, 4, 5], "colnam": [2, 4], "r": [2, 5], "intens": [2, 5], "00000": 2, "00833": 2, "2": [2, 5], "01667": 2, "3": [2, 3], "02500": 2, "4": 2, "03333": 2, "provid": [2, 3, 4, 5], "name": [2, 5], "dictionari": [2, 5], "renam": [2, 4], "annoi": 2, "default": [2, 5], "work": 2, "class": [2, 5], "ha": [2, 3, 5], "varieti": 2, "method": [2, 5], "crop": [2, 5], "visual": 2, "more": [2, 5], "instanti": 2, "figur": [2, 5], "size": [2, 5], "640x480": 2, "gt": 2, "xlabel": 2, "ylabel": 2, "place": [2, 5], "restrict": [2, 5], "specif": [2, 3], "rang": [2, 5], "between": [2, 5], "8": 2, "21": 2, "function": [2, 5], "oper": 2, "modifi": [2, 5], "within": [2, 5], "object": [2, 5], "real": 2, "meat": 2, "come": 2, "deconvolut": 2, "discret": 2, "describ": 2, "xxx": 2, "typic": 2, "estim": [2, 5], "subtract": [2, 5], "baselin": [2, 5], "reconstitut": 2, "luckili": 2, "done": 2, "call": [2, 5], "5": [2, 5], "correct": [2, 5], "298": 2, "3278": 2, "51it": 2, "mixtur": [2, 3, 5], "43it": 2, "375233": 2, "170581": 2, "582465": 2, "837002": 2, "42223": 2, "458133": 2, "066815e": 2, "447598": 2, "353154": 2, "019871": 2, "35248": 2, "537147": 2, "229824e": 2, "531857": 2, "312382": 2, "629760": 2, "14881": 2, "491630": 2, "785779e": 2, "522634": 2, "342800": 2, "970608": 2, "10738": 2, "841299": 2, "288661e": 2, "17": 2, "293591": 2, "341357": 2, "618590": 2, "12411": 2, "264922": 2, "489352e": 2, "6": [2, 5], "To": [2, 5], "well": [2, 5], "onc": 2, "again": 2, "composit": 2, "also": [2, 5], "assess_fit": [2, 5], "reconstruct": [2, 5], "score": [2, 5], "defin": [2, 5], "frac": [2, 5], "term": 2, "window": [2, 5], "interpeak": [2, 5], "thei": 2, "present": [2, 4, 5], "9": [2, 3, 5], "print": [2, 5], "out": [2, 5], "assess": [2, 5], "report": [2, 5], "card": 2, "success": 2, "t": [2, 5], "000": 2, "792": 2, "0014": 2, "800": 2, "9968": 2, "window_id": 2, "time_start": 2, "time_end": 2, "signal_area": 2, "inferred_area": 2, "signal_vari": 2, "signal_mean": 2, "signal_fano_factor": 2, "reconstruction_scor": 2, "window_typ": 2, "applied_toler": 2, "statu": 2, "79167": 2, "786008e": 2, "789806e": 2, "356338e": 2, "08": 2, "12898": 2, "182666": 2, "33774": 2, "820750": 2, "001363": 2, "01": [2, 5], "valid": [2, 5], "390560e": 2, "07": 2, "386043e": 2, "740014e": 2, "14117": 2, "356822": 2, "26492": 2, "309842": 2, "996752": 2, "know": 2, "linear": [2, 5], "calibr": [2, 5], "curv": [2, 5], "relat": [2, 5], "known": 2, "map_compound": 2, "map": [2, 5], "user": [2, 5], "two": [2, 5], "interest": 2, "slope": [2, 5], "10547": 2, "intercept": [2, 5], "205": 2, "unit": [2, 5], "\u00b5m": 2, "b": 2, "26401": 2, "54": 2, "nm": 2, "quant_peak": 2, "map_peak": [2, 5], "62976": 2, "169": 2, "326159": 2, "61859": 2, "56": 2, "410223": 2, "successfulli": 2, "id": 2, "reflect": 2, "retent": [2, 5], "lead": 2, "domin": 2, "shoulder": 2, "predomin": 2, "In": [2, 5], "fail": 2, "12": 2, "example_overlap": 2, "248": 2, "1552": 2, "01it": 2, "99": 2, "42it": 2, "f": [2, 5], "810": 2, "22": 2, "090": 2, "9788": 2, "poorli": 2, "need": [2, 4], "adjust": [2, 5], "bound": [2, 5], "add": 2, "posit": [2, 5], "pair": 2, "veri": [2, 5], "noisi": [2, 5], "increas": [2, 5], "toler": [2, 5], "tol": [2, 5], "review": 2, "24": 2, "990": 2, "0624": 2, "amp": 2, "fano": [2, 5], "ratio": [2, 5], "small": [2, 5], "factor": [2, 5], "compar": [2, 5], "accept": [2, 5], "check": 2, "second": 2, "approxim": [2, 5], "forc": 2, "convolut": 2, "enforc": [2, 5], "around": 2, "enforced_loc": [2, 5], "1421": 2, "59it": 2, "32it": 2, "900": 2, "0000": 2, "0001": 2, "even": 2, "though": 2, "did": 2, "exactli": 2, "approach": 2, "shallow": 2, "example_shallow": 2, "csv": 2, "exclud": 2, "464": 2, "13it": 2, "99it": 2, "910": 2, "18": 2, "080": 2, "79": 2, "0354": 2, "appreci": 2, "suggest": 2, "miss": [2, 5], "ad": [2, 5], "As": [2, 5], "broad": 2, "better": 2, "50": 2, "enforced_width": [2, 5], "465": 2, "90it": 2, "28it": 2, "44": 2, "55": 2, "43": 2, "0059": 2, "0079": 2, "0045": 2, "welcom": 3, "document": 3, "limit": [3, 5], "yet": 3, "robust": 3, "interfac": 3, "accur": 3, "effici": 3, "peak": [3, 5], "chromatographi": 3, "high": 3, "liquid": 3, "goal": 3, "reduc": 3, "make": 3, "run": [3, 5], "most": [3, 5], "consum": 3, "step": [3, 5], "pip": 3, "upgrad": 3, "danger": 3, "think": 3, "error": [3, 5], "messag": 3, "termin": 3, "pretti": 3, "pre": 3, "releas": 3, "git": 3, "com": 3, "dev": 3, "egg": 3, "depend": 3, "newer": 3, "numpi": [3, 5], "scipi": [3, 5], "tqdm": 3, "termcolor": 3, "fname": 4, "delimit": 4, "dropna": 4, "fals": [4, 5], "pars": 4, "chromatogram": [4, 5], "return": [4, 5], "str": 4, "path": 4, "must": [4, 5], "xslx": 4, "dict": [4, 5], "desir": 4, "assum": [4, 5], "begin": 4, "without": 4, "skip": 4, "ani": [4, 5], "charact": 4, "bool": [4, 5], "true": [4, 5], "nan": [4, 5], "drop": 4, "type": [4, 5], "core": [4, 5], "frame": [4, 5], "time_window": 5, "none": 5, "base": 5, "window_prop": 5, "label": 5, "integ": 5, "order": 5, "own": 5, "total": 5, "unmixed_chromatogram": 5, "matrix": 5, "row": 5, "correspond": 5, "point": 5, "probabl": 5, "densiti": 5, "ndarrai": 5, "quantified_peak": 5, "convert": 5, "gener": 5, "afer": 5, "param_opt": 5, "arrai": 5, "tempor": 5, "param_pcov": 5, "covari": 5, "uncertainti": 5, "calcul": 5, "sqrt": 5, "diag": 5, "big": 5, "caveat": 5, "param": 5, "pcov": 5, "model": 5, "about": 5, "optimum": 5, "attribut": 5, "caution": 5, "d": 5, "fano_tol": 5, "001": 5, "verbos": 5, "whether": 5, "adequ": 5, "float": 5, "deviat": 5, "perfectli": 5, "awai": 5, "zero": 5, "evalu": 5, "inerpeak": 5, "summari": 5, "screen": 5, "problemat": 5, "score_df": 5, "boolean": 5, "repres": 5, "alpha": 5, "paramt": 5, "r_t": 5, "sigma": 5, "s_i": 5, "cast": 5, "perfect": 5, "practic": 5, "purpos": 5, "deem": 5, "epsilon": 5, "left": 5, "right": 5, "leq": 5, "rightarrow": 5, "poor": 5, "due": 5, "nois": 5, "short": 5, "durat": 5, "determin": 5, "2_": 5, "langl": 5, "rangl": 5, "averag": 5, "f_": 5, "sum": 5, "limits_": 5, "sigma_": 5, "free": 5, "correct_baselin": 5, "return_df": 5, "precis": 5, "sensit": 5, "clip": 5, "int": 5, "dimens": 5, "undertaken": 5, "befor": 5, "after": 5, "progress": 5, "bar": 5, "decim": 5, "round": 5, "corrected_df": 5, "origin": 5, "summar": 5, "morh\u00e1c": 5, "matousek": 5, "2008": 5, "avoid": 5, "start": 5, "option": 5, "analysi": 5, "cropped_df": 5, "deconvolve_peak": 5, "param_bound": 5, "max_it": 5, "1000000": 5, "optimizer_kwarg": 5, "should": 5, "directli": 5, "instead": 5, "makeup": 5, "dure": 5, "modif": 5, "entri": 5, "form": 5, "lower": 5, "upper": 5, "effect": 5, "multipl": 5, "magnitud": 5, "respect": 5, "replac": 5, "protocol": 5, "keyword": 5, "argument": 5, "curve_fit": 5, "peak_prop": 5, "boundari": 5, "prevent": 5, "realist": 5, "regim": 5, "serious": 5, "slow": 5, "down": 5, "tenth": 5, "ten": 5, "minimum": 5, "standard": 5, "enforcement_toler": 5, "rel_height": 5, "approx_peak_width": 5, "buffer": 5, "return_peak": 5, "dt": 5, "enforce_toler": 5, "identifi": 5, "prefer": 5, "promim": 5, "rel": 5, "height": 5, "local": 5, "want": 5, "filter": 5, "pad": 5, "side": 5, "constrain": 5, "docstr": 5, "addit": 5, "peak_df": 5, "alwai": 5, "norma": 5, "2s_": 5, "max": 5, "pi": 5, "erf": 5, "s_": 5, "loc_toler": 5, "include_unmap": 5, "arbitrarili": 5, "v0": 5, "accommod": 5, "concentraion": 5, "glucos": 5, "anoth": 5, "unmap": 5, "remain": 5, "popul": 5, "tabl": 5, "doe": 5, "affect": 5, "_ax": 5, "axi": 5, "__author__": [], "__email__": [], "griffinchur": [], "gmail": [], "__version__": [], "_assign_window": [], "95": [], "break": [], "window_df": [], "assign": [], "copi": [], "_compute_skewnorm": [], "x": [], "lineshap": [], "shape": [], "loc": [], "parat": [], "scaled_pdf": [], "pdf": [], "suppli": [], "same": [], "_fit_skewnorm": [], "consititut": [], "length": [], "construct": [], "_score_reconstruct": [], "per": [], "basi": [], "don": [], "whole": [], "math": [], "j": [], "n_": [], "2a_j": [], "alpha_j": [], "r_": [], "t_j": [], "sigma_j": [], "page": [], "auto": [], "creat": [], "sphinx": [], "autoapi": [], "inf": 5, "par": []}, "objects": {"hplc": [[4, 0, 0, "-", "io"], [5, 0, 0, "-", "quant"]], "hplc.io": [[4, 1, 1, "", "load_chromatogram"]], "hplc.quant": [[5, 2, 1, "", "Chromatogram"]], "hplc.quant.Chromatogram": [[5, 3, 1, "", "assess_fit"], [5, 3, 1, "", "correct_baseline"], [5, 3, 1, "", "crop"], [5, 3, 1, "", "deconvolve_peaks"], [5, 4, 1, "", "df"], [5, 3, 1, "", "fit_peaks"], [5, 3, 1, "", "map_peaks"], [5, 4, 1, "", "param_opt"], [5, 4, 1, "", "param_pcov"], [5, 4, 1, "", "peaks"], [5, 4, 1, "", "quantified_peaks"], [5, 4, 1, "", "scores"], [5, 3, 1, "", "show"], [5, 4, 1, "", "unmixed_chromatograms"], [5, 4, 1, "", "window_props"]]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class", "3": "py:method", "4": "py:attribute"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"], "3": ["py", "method", "Python method"], "4": ["py", "attribute", "Python attribute"]}, "titleterms": {"credit": 0, "cite": 0, "hplc": [0, 4, 5], "py": 0, "methodologi": 1, "The": 1, "problem": 1, "how": 1, "It": 1, "work": 1, "step": 1, "1": 1, "correct": 1, "drift": 1, "baselin": 1, "2": 1, "identif": 1, "peak": [1, 2], "maxima": 1, "includ": 1, "obscur": 1, "3": 1, "clip": 1, "chromatogram": [1, 2], "Into": 1, "window": 1, "4": 1, "per": 1, "estim": 1, "constitu": 1, "signal": 1, "5": 1, "6": 1, "integr": 1, "evalu": 1, "composit": 1, "mixtur": 1, "quickstart": 2, "load": 2, "view": 2, "detect": 2, "fit": 2, "quantifi": 2, "deconvolv": 2, "heavili": 2, "overlap": 2, "subtl": 2, "about": 3, "instal": 3, "io": 4, "quant": 5, "submodul": [], "packag": [], "content": [], "modul": [], "function": [], "class": [], "api": [], "refer": []}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "nbsphinx": 4, "sphinx": 57}, "alltitles": {"Credit": [[0, "credit"]], "Citing hplc-py": [[0, "citing-hplc-py"]], "Methodology": [[1, "Methodology"]], "The Problem": [[1, "The-Problem"]], "How It Works": [[1, "How-It-Works"]], "Step 1: Correcting for a Drifting Baseline": [[1, "Step-1:-Correcting-for-a-Drifting-Baseline"]], "Step 2: Identification of Peak Maxima and Including Obscured Peaks": [[1, "Step-2:-Identification-of-Peak-Maxima-and-Including-Obscured-Peaks"]], "Step 3: Clipping the Chromatogram Into Windows": [[1, "Step-3:-Clipping-the-Chromatogram-Into-Windows"]], "Step 4: Per-Window Estimation of Constituent Signals": [[1, "Step-4:-Per-Window-Estimation-of-Constituent-Signals"]], "Steps 5 & 6: Integration of Signal and Evaluating Composition of Mixture": [[1, "Steps-5-&-6:-Integration-of-Signal-and-Evaluating-Composition-of-Mixture"]], "Quickstart": [[2, "Quickstart"]], "Loading and viewing chromatograms": [[2, "Loading-and-viewing-chromatograms"]], "Detecting and Fitting Peaks": [[2, "Detecting-and-Fitting-Peaks"]], "Quantifying Peaks": [[2, "Quantifying-Peaks"]], "Deconvolving Heavily-Overlapping and Subtle Peaks": [[2, "Deconvolving-Heavily-Overlapping-and-Subtle-Peaks"]], "hplc.io": [[4, "module-hplc.io"]], "hplc.quant": [[5, "module-hplc.quant"]], "About": [[3, "about"]], "Installation": [[3, "installation"]]}, "indexentries": {}})